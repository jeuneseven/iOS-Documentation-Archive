[Secure Coding Guide 原文链接](https://developer.apple.com/library/content/documentation/Security/Conceptual/SecureCodingGuide/Introduction.html#//apple_ref/doc/uid/TP40002415)

# 简介
## 安全编码指南简介

安全编码时一种编写软件中的实践，它是为了抵抗恶意或恶作剧的人或者程序的攻击。一个不安全的程序能够提供给攻击者入口来控制一台服务器或者用户的电脑，从拒绝单一用户的服务攻击，到安全妥协，丢失服务以及损坏数千用户的系统。安全编码帮助保护用户的数据被偷窃或破坏。  
安全编码对于所有的软件都很重要，小到你编写的一段脚本，大到商业级的应用。如果你编写的是软件的话，要熟悉了解这个文档中的信息。

### 概览

安全并非某种能够在事后添加到软件中的东西。就像是一个卡片做的盾牌无法通过添加一把锁头来锁住门保证安全一样，一个不安全的工具或应用可能需要大量的重新设计保证安全。你必须判断对于你的软件的危险类型，并贯彻始终在开发过程中加入安全编码。本书描述了缺陷的特定类型并给出了编码硬化技术的指南来对其进行修复。

#### 黑客和攻击者

与媒体报道中常提到的方式相反，在计算机领域，黑客其实指代的是专家程序员——一个喜欢研究复杂代码或操作系统的人。通常来讲，黑客并不带有恶意。当大部分的黑客查找到安全漏洞时，他们会通知负责该代码的公司或组织以便能够修复问题。不过，不幸的是，一小部分黑客会利用漏洞来攻击，并发布这些给其他用户来使用。

#### 没有平台是免疫的

### 如何使用本文档

首先，让你自己熟悉一下《安全概览》中的概念。  
本文档。  
其他的章节。  

- 《避免缓冲溢出和下溢》描述了缓冲溢出的几种类型并解释了如何避免。
- 《非法输入和进程间通信》讨论了你该如何验证每种从不可信任的源头到你的程序中的输入。
- 《种类条件和安全的文件操作》解释了种类条件是如何发生的，讨论了如何避免它，并描述了不安全和安全的文件操作。
- 《提高权限的安全性》
- 《设计安全的用户界面》
- 《设计安全的帮助者和守护者》便捷的任务列表，你可以在开发应用过程中用它，附录《第三方软件安全指南》给第三方应用提供了一个指南。

附录《安全开发检查表》提供了一个

### 另请参阅

本文档聚焦于安全上易受攻击和使用 macOS 或 iOS 的开发者所特殊关注的编程实践。更多通用的处理方法，参见以下书籍和文档：  

- 参见 Viega 和 McGraw《构建安全的软件》Addison Wesley，2002；了解常见的安全编程讨论，尤其是它相关的 C 编程和编写脚本。
- 参见 Wheeler《安全编程 HOWTO》，在 http://www.dwheeler.com/secure-programs/ 网站上可见；了解几种易受攻击的安全问题类型和基于 UNIX 操作系统的编程指南，大部分都可以应用在 macOS 上。
- 参见 Cranor 和 Garfinkel《安全和可用：设计用户可用的安全的系统》O’Reilly，2005；了解编写用户界面提高安全性的相关信息。

有关安全相关的文档和应用编程接口（APIs），参见以下文档：  

- 有关安全网络的相关信息，参见《安全传输参考》。
- 有关 macOS 校验和验证的 APIs 相关信息，参见《校验服务 C 参考》和《安全基础框架参考》。
- 如果你在使用数码证书来教研，参见《证书，密钥和可信任的服务参考》。
- 有关密码的安全存储和其他秘密，刹那间《钥匙串服务参考》。

有关在 web 应用设计中的安全相关信息，浏览 http://www.owasp.org/。

## 安全上易受攻击的类型

### 缓冲溢出

### 非法输入

### 种类判断

### 进程间通信

### 不安全的文件操作

### 访问控制问题

### 安全存储和加密

### 社会工程

# 附录A：安全开发检查表

## 特权的使用

## 数据，配置和临时文件

## 网络端口使用

## 审查日志

## 客户端-服务端鉴权

## 整型和缓存溢出

## 加密函数的使用

## 安装和加载

## 外部工具的使用和库

## 内核安全

# 附录B：第三方软件安全指南

## 尊重用户的隐私

## 提供更新信息

## 讲信息存储在适当的位置

## 避免请求超出需求的特权

## 实现安全开发实践

## 为安全做测试

## 帮助资源

# 词汇表

**AES 加密**高级标准加密的缩写。联邦标准信息处理过程（FIPS）的发布版本中 197 中有相关描述。AES 已经被美国政府应用在敏感信息，未分类信息的保护当中。  
**攻击者**指代某些故意的尝试让一个程序或操作系统做一些它本来不能做的事的人，比如允许攻击者执行代码或读取私有数据。  
**鉴权**一个人或其他实体（比如服务器）证明它是谁（或是什么）的过程。与授权相对。  
**授权**一个类似用户或服务器的实体获取权限来执行一个特权操作的过程。（）授权通常包含首次鉴权。参见「鉴权」。  
**缓冲区溢出**给一个内存缓冲区插入了过多数据，超过了它的缓冲区，会造成内存中的区域超过缓冲区的部分被重写。另参见《堆溢出》和《栈溢出》。  
**CDSA**  
**CERT协调中心**  
**证书**参见《数字证书》。  
**常见条件**由美国、加拿大、英国、法国、德国和荷兰政府制定的评估软件产品开发安全性的一系列安全过程。  
**CSSM**  
**CVE**  
**数字证书**数据的集合，用来验证持有者的等同性。macOS 对数字证书支持 X.509 标准。  
**开发**  
**FileVault**  
**黑客**专家程序员——通常指具有非凡技能的人。大部分的黑客不会攻击其他的程序，某些发布漏洞的是为了强迫软件开发者修复缺陷。  
**堆**  
**堆溢出**在堆中的缓冲区溢出。  
**同形异意词**  
**整形溢出**整形缓存区溢出。  
**Kerberos**  
**钥匙串**  
**钥匙串访问工具**一个公开的 API，用来操作钥匙串中的数据。  
**钥匙串服务**一个公开的 API，可以用来操作钥匙串中的数据。  
**信任等级**  
**不可否认性**让用户否认执行一项操作成为不可能的一种过程或技术（比如使用特定的信用卡号码）。  
**开放目录**由 macOS 提供的目录服务，用来安全的存储密码和用户鉴权信息。  
**权限**参见「特权」。  
**网络钓鱼**一种社会工程学技术，其中使用欺骗合法企业的电子邮件或网页来诱骗用户将个人数据和机密（例如密码）提供给具有恶意意图的人。  
**政策数据库**一个包含安全服务器规则集合的数据库，用来判断权限。  
**特权操作**一种需要特殊权限或特权的操作。  
**特权**访问一个文件或目录的类型（读、写、执行、穿过等等）准许一个用户或群组。  
**条件判断**两个事件顺序相冲突。  
**根库**恶意代码，通过在内核中运行，不仅可以接管系统的控制权，还可以掩盖其自身存在的所有证据。  
**根特权**在系统上使用不严格的权限执行任意操作。  
**信号**一种从一个基于Unix的操作系统（比如 macOS）的进程发送消息到另一个的过程。  
**社会工程**一种安全方面的应用，引诱用户放弃隐私或访问一个攻击者的电脑。  
**智能卡**一种和信用卡类似尺寸的塑料材质的卡，内部有微处理器嵌入和内存。一个智能卡能够存储和处理信息，包括密码，证书和密钥。  
**栈**一块内存的区域，用来给指定程序保留，以及控制程序流。数据被压入以及被移出是以后进先出的方式。栈向下增长（相对于低内存地址）。与堆相对。  
**栈溢出**栈缓存区溢出。  
**检验时间使用的时间(TOCTOU)**在一个攻击者生成、写入或者在一个程序检查和写入一个文件之间替换一个文件的时候的一种判断条件。  
**信任政策**一系列为合理使用鉴权指定特定信任等级的规则。比如，一个浏览器的信任政策可能表示一个证书是否过期了，用户应该在安全的打开一个网页服务之前及时授权。  
**安全隐患**指代这么一种功能：一个程序已经被写入——要么是已经设计好的错误或bug——这让它可能被黑客攻击。  