[Key-Value Coding Programming Guide](https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/KeyValueCoding/index.html#//apple_ref/doc/uid/10000107-SW1)

# 开始
## 关于KVC

KVC是一种通过NSKeyValueCoding非正式协议启动的机制，遵循该协议的对象会提供它属性的间接访问。当一个对象符合KVC时，它的属性是可以通过字符串参数以一个精确、唯一的消息接口进行寻址的。这种间接的访问机制对于通过实例变量和它的关联存取方法是一种补充。  
通常使用存取方法来访问一个对象的属性。取方法（即getter）返回一个属性的值。存方法（即setter）设置一个属性的值。在OC当中你还可以直接访问一个属性的底层的实例变量。以任何方式访问一个对象的属性都是直接的，但是需要调用一个属性特定的方法或者变量名。随着属性的增加或变更，这些存取这些属性的方法的代码也要变更。作为对比，一个符合KVC的对象提供了一种简单的消息接口，它可以贯穿所有这些属性。  
KVC是一个很多其他Cocoa技术的底层原理，比如KVO，cocoa绑定，Core Data和AppleScript功能。KVC还可以在某些情况下帮助你简化代码。  

### 使用符合KVC的对象

当对象继承自NSObject（直接或间接）时就会采用了KVC，同时遵守了NSKeyValueCoding协议并为基本方法提供了一个默认的实现。这样的一个对象能够让其他的对象通过一个简洁的消息接口做如下事情：  

* 访问对象属性。协议列举的方法，类似通用的取方法 valueForKey: 和通用的存方法 setValue:forKey:，通过对象的属性名或key，将其参数化为字符串来访问。这些方法的默认实现和相关方法使用了key来定位和与底层数据交互，这在《访问对象属性》中有相关描述。
* 操作集合属性。访问方法对于对象的集合属性（比如NSArray对象）所做的工作的默认实现就像其他的属性一样。此外，如果一个对象给一个属性定义了一个集合存取方法，它就开启了键值对访问集合内容的能力。这通常比直接访问并让你通过标准接口与自定义集合对象进行交互更加高效，如《访问集合属性》中描述的方法。
* 对于集合对象调用集合操作。当访问一个复合KVC的对象的集合属性时，你可以在key字符串中插入一个集合操作符，在《使用集合操作符》中相关描述。集合操作符会通知默认的NSKeyValueCoding的getter方法在集合上实现一个动作，并返回一个新的或者筛选过的集合的版本，或者一个单一的值来表示某些集合的特征。
* 访问非对象的属性。协议的默认实现会检测非对象属性，包括标准量和结构体，并自动的对其进行封包和解包作为对象用在协议的接口中，这在《展示非对象值》中有相关描述。此外，协议声明了一个方法允许遵循的对象为当一个nil通过KVC接口设置给一个非对象的属性这种情况提供一个合适的行为。
* 通过key路径访问属性。当你拥有一个层级的符合KVC的对象时，你可以使用基于方法的key路径层层调用，使用一个调用就能获取或设置在层级中的深层的值。

### 为一个对象采用KVC

为了让你自定义的对象能够遵循KVC，你需要确保它们采用了NSKeyValueCoding非正式协议，并实现了相应的方法，类似valueForKey: 作为通用的 getter 以及 setValue:forKey: 作为通用的setter方法。幸运的是，如上文所述，NSObject 遵循了该协议，并为这些方法提供了默认实现和基本方法。所以，如果你的对象是从NSObject（或者它的众多子类）获得的，那么很多工作已经为你做好了。  
为了让默认的方法能够执行其工作，你要确保你的的对象的存取方法和实例变量遵守一个特定的定义好的模式。这会让默认实现能够查找到你的对象的属性以便相应键值编码信息。随后你就可以选择扩展和自定义键值编码，通过提供方法来验证和处理某个特定的例子。

### Swift中的KVC

继承自NSObject的Swift对象或者它的子类之一的属性默认是符合键值编码的。鉴于在OC当中，一个属性的存取方法和实例变量必须遵循某个特定模式，一个在Swift中声明的标准的属性自动的会确保这一点。另一方面，很多协议的功能要么不相关，要么使用在OC中不存在的原生Swift构造或技术处理的更好。比如，由于所有的Swift的属性都是对象，你始终不用使用默认的实现来制定处理非对象的属性。  
所以，当KVC协议方法直接转移到Swift时，本指南主要聚焦在OC上，在你需要做的更多来确保稳定性以及KVC更常用的地方。在整个指南中都注意到了在Swift中要求采用明显不同方法的情况。  
更多关于使用Cocoa技术的Swift，阅读《使用Cocoa和OC（Swift3）》。有关Swift的详细介绍，阅读《Swift编程语言》（Swift3)。

### 其他的依赖KVC的Cocoa的技术

遵守KVC的对象能够广泛的参与Cocoa技术，这些技术依赖于这种访问，包括：  

* KVO。这种机制让对象能够通过在其他对象的属性的改变中注册异步通知驱动，如《KVO编程指南》中所描述的那样。
* Cocoa绑定。这个技术的集合完整实现了MVC范式，模型封装应用数据，视图展示和编辑数据，控制器协调两者。阅读《Cocoa绑定编程话题》了解更多关于Cocoa绑定。
* Core Data。这个框架为和对象生命周期和对象图表管理相关的常见任务场景提供了一个通用的、自动的解决方案，包括持久化。你可以在《Core Data编程指南》中阅读关于Core Data。
* AppleScript。这个脚本语言能够直接控制可脚本控制的应用以及macOS的很多部分。Cocoa的脚本化支持利用KVC来获取或设置可脚本化对象的信息。NSScriptKeyValueCoding 非正式协议中的方法提供了额外的功能与KVC结合使用，包括通过在多个键值中的索引获取和设置键值，以及强制转换一个键值给一个恰当的数据类型。《AppleScript概览》提供了一个关于AppleScript的高层的概览以及它相关的技术。

# KVC基本原理
## 访问对象的属性

## 访问集合属性

## 使用集合操作符

## 表示非对象值

## 校验属性

## 存取器搜索模式

# 采用KVC
## 获取基本的KVC合规

## 定义集合方法

## 处理非对象值

## 增加校验

## 描述属性关系

## 性能设计

## 合规检查表